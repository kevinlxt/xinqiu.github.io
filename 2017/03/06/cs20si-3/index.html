<!DOCTYPE html>
<html lang="en">
    <head>
    <!-- 
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.3.0 -->

    <!-- Title -->
    
    <title>
        
            Tensorflow for Deep Learning 3 | 
        
        一人Code
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Meta & Info -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="Xin Qiu">
    <meta name="description" content="写给自己的Blog">
    <meta name="keywords" content="一人Code|写给自己的Blog,deep-learning">

    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="一人Code">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://xinqiu.me">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Tensorflow for Deep Learning 3 | 一人Code">
    <meta property="og:description" content="写给自己的Blog">
    <meta property="og:article:tag" content="deep-learning"> 

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.en.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->


<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }
</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>



    <script src="/js/jquery.min.js"></script>
    <script src="/js/queue.js"></script>

    <!-- UC Browser Compatible -->
    <script>
        var agent = navigator.userAgent.toLowerCase();
        if(agent.indexOf('ucbrowser')>0) {
            document.write("<link rel=\"stylesheet\" href=\"/css/uc.css\">");
            alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
        }
    </script>

    

    
    <!-- Google Analytics -->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-57881840-1', 'auto');ga('send', 'pageview');
    </script>
    

    <!-- Bing Background -->
    

    <!-- Custom Head -->
    
        
            <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-57881840-1', 'auto'); ga('send', 'pageview'); </script>
        
    
<link rel="stylesheet" href="/css/prism-coy.css" type="text/css"></head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#TensorFlow__u7EBF_u6027_u56DE_u5F52"><span class="post-toc-number">1.</span> <span class="post-toc-text">TensorFlow 线性回归</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-6"><a class="post-toc-link" href="#u5206_u6790_u4EE3_u7801"><span class="post-toc-number">1.0.0.1.</span> <span class="post-toc-text">分析代码</span></a></li></ol></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#u4F18_u5316_u5668_28Optimizers_29"><span class="post-toc-number">1.0.1.</span> <span class="post-toc-text">优化器(Optimizers)</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-6"><a class="post-toc-link" href="#Optimizer_u5217_u8868"><span class="post-toc-number">1.0.1.1.</span> <span class="post-toc-text">Optimizer列表</span></a></li></ol></li></ol></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#TensorFlow__u903B_u8F91_u56DE_u5F52"><span class="post-toc-number">2.</span> <span class="post-toc-text">TensorFlow 逻辑回归</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#u603B_u7ED3"><span class="post-toc-number">2.0.1.</span> <span class="post-toc-text">总结</span></a></li></ol></li></ol></li></ol>

        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        <!-- Custom Thumbnail -->
        <div class="post_thumbnail-custom mdl-card__media mdl-color-text--grey-50" style="background-image:url(img/tf.jpg)">
    
            <p class="article-headline-p">
                Tensorflow for Deep Learning 3
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Xin Qiu</strong>
        <span>Mar 06, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
            <i class="material-icons" role="presentation">devices other</i>
            <span class="visuallyhidden">devices other</span>
        </button>
        <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
            <li class="mdl-menu__item">Read this article on other device</li>
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACZ0lEQVR42u3aQXLCMAwFUO5/6fYAncD/NjIp87xiSEP8srBUSY+fr14PPDw8PDw8PDy8m/Ee8Xp+19+rV5/bq/Xe8PDw8I7wXhy1AeD5K3h+19UeFveGh4eHd5B39cirz/kj86Cyszc8PDy8O/P2w0n7PR4eHt5/5yWMvGDRJu54eHh49+HtpLbtEZ+XfY/WWvDw8PBiXt5kOv/5aH8PDw8PL+C1K2995Ql3G6he7BAPDw9vmJcfxDsNrSTY5EWNF/vBw8PDG+a1JYB8qPT53++EnKKMi4eHhzfASxLcZOt1ySC+2o4v4OHh4U3z8kZ+Hh7ey2jTazw8PLxpXv7IpNCQJ+hrSXk0TICHh4d3hLd20NfjUEGw2QlOeHh4eGd4bYl2pwyR//La2AEeHh7eGd5aAp2HlrV726YXHh4e3nle28LPw0Pb0HrD68bDw8M7yEuaVXmbKi86rBWU6wYYHh4e3gBvrSTRJtBRKXYnXOHh4eEd5LXNreiYflPTKx8gwMPDw/ssby1FXjvu27CEh4eHd09eHhh2SsB5oyv6Bg8PD++jvLWSbjte0BaI31aMwMPDwxvgzaXR7aBA0ajDw8PDO8hbO6zXDvScXb8IPDw8vGFeu9oBgrwUm4+lFoEBDw8Pb4DXHsftvfkAwVpAiooReHh4eAO8vPTQJsRzgaFugOHh4eEN8HYO6P2g0gabOjDg4eHhfZSXl2Xb1lo+0DAYGPDw8PDGeG15YidNL/4BwMPDwzvIa0es1hpdawXcQ2VcPDw8vIEG2Nqmk9+ph6uuXjEeHh7eMO/7Fh4eHh4eHh4e3g3WL2EJzkr/kMdcAAAAAElFTkSuQmCC">
        </ul>
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/deep-learning/">deep-learning</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    
    <!-- Leancloud Views -->
        <a class="post_share-link" href="#">
            <li class="mdl-menu__item">
                <span id="/2017/03/06/cs20si-3/" class="leancloud-views_num" data-flag-title="Tensorflow for Deep Learning 3">
     &nbsp;Views
</span>

            </li>
        </a>
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=Tensorflow for Deep Learning 3&url=http://xinqiu.me//2017/03/06/cs20si-3/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                Share to Weibo
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=Tensorflow for Deep Learning 3&url=http://xinqiu.me//2017/03/06/cs20si-3/index.html&via=Xin Qiu" target="_blank">
            <li class="mdl-menu__item">
                Share to Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://xinqiu.me//2017/03/06/cs20si-3/index.html" target="_blank">
            <li class="mdl-menu__item">
                Share to Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://xinqiu.me//2017/03/06/cs20si-3/index.html" target="_blank">
            <li class="mdl-menu__item">
                Share to Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <blockquote>
<p>笔记3: 用 TensorFlow 实现线性回归和逻辑回归</p>
</blockquote>
<h3 id="TensorFlow__u7EBF_u6027_u56DE_u5F52"><a href="#TensorFlow__u7EBF_u6027_u56DE_u5F52" class="headerlink" title="TensorFlow 线性回归"></a>TensorFlow 线性回归</h3><p>这里介绍了一个简单的线性分类例子。</p>
<p>问：是否社区中的火灾数量与小偷存在一定的关系？换句话说，是否火灾数 X 与小偷数 Y 之前，存在 Y = f(X)?</p>
<p>这里使用 the U.S. Commission on Civil Rights 收集的数据集来分析。</p>
<p>数据集描述：</p>
<p>Name: 芝加哥火灾与小偷</p>
<p>X = 每1000个住宅单元的火灾数</p>
<p>Y = 每1000个人口中的小偷数</p>
<p>数据来源于芝加哥的不同区域，总计 42 个地区</p>
<p>答：</p>
<p>首先假设火灾数与小偷数是线性关系： Y = wX + b</p>
<p>使用均方误差作为损失函数(Loss Function)</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
<span class="token keyword">import</span> xlrd

DATA_FILE <span class="token operator">=</span> <span class="token string">'data/fire_theft.xls'</span>

<span class="token comment" spellcheck="true"># Step 1: read in data from the .xls file</span>
<span class="token comment" spellcheck="true"># book = xlrd.open_workbook(DATA_FILE, encoding_override="utf-8")</span>
<span class="token comment" spellcheck="true"># sheet = book.sheet_by_index(0)</span>
<span class="token comment" spellcheck="true"># data = np.asarray([sheet.row_values(i) for i in range(1, sheet.nrows)])</span>
<span class="token comment" spellcheck="true"># n_samples = sheet.nrows - 1</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd  <span class="token comment" spellcheck="true"># 使用pandas更简便</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>DATA_FILE<span class="token punctuation">)</span>
data <span class="token operator">=</span> df<span class="token punctuation">.</span>values
n_samples <span class="token operator">=</span> len<span class="token punctuation">(</span>df<span class="token punctuation">.</span>index<span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># Step 2: create placeholders for input X (number of fire) and label Y (number of theft)</span>
X <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'X'</span><span class="token punctuation">)</span>
Y <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'Y'</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># Step 3: create weight and bias, initialized to 0</span>
w <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'weights'</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'bias'</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># Step 4: build model to predict Y</span>
Y_predicted <span class="token operator">=</span> X <span class="token operator">*</span> w <span class="token operator">+</span> b 

<span class="token comment" spellcheck="true"># Step 5: use the square error as the loss function</span>
loss <span class="token operator">=</span> tf<span class="token punctuation">.</span>square<span class="token punctuation">(</span>Y <span class="token operator">-</span> Y_predicted<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'loss'</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># Step 6: using gradient descent with learning rate of 0.01 to minimize loss</span>
optimizer <span class="token operator">=</span> tf<span class="token punctuation">.</span>train<span class="token punctuation">.</span>GradientDescentOptimizer<span class="token punctuation">(</span>learning_rate<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">)</span><span class="token punctuation">.</span>minimize<span class="token punctuation">(</span>loss<span class="token punctuation">)</span>

<span class="token keyword">with</span> tf<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> sess<span class="token punctuation">:</span>
    <span class="token comment" spellcheck="true"># Step 7: initialize the necessary variables, in this case, w and b</span>
    sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>global_variables_initializer<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
    writer <span class="token operator">=</span> tf<span class="token punctuation">.</span>summary<span class="token punctuation">.</span>FileWriter<span class="token punctuation">(</span><span class="token string">'./my_graph/03/linear_reg'</span><span class="token punctuation">,</span> sess<span class="token punctuation">.</span>graph<span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># Step 8: train the model</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># train the model 100 times</span>
        total_loss <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> data<span class="token punctuation">:</span>
            <span class="token comment" spellcheck="true"># Session runs train_op and fetch values of loss</span>
            _<span class="token punctuation">,</span> l <span class="token operator">=</span> sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span>optimizer<span class="token punctuation">,</span> loss<span class="token punctuation">]</span><span class="token punctuation">,</span> feed_dict<span class="token operator">=</span><span class="token punctuation">{</span>X<span class="token punctuation">:</span> x<span class="token punctuation">,</span> Y<span class="token punctuation">:</span>y<span class="token punctuation">}</span><span class="token punctuation">)</span>
            total_loss <span class="token operator">+=</span> l

        <span class="token keyword">print</span> <span class="token string">'Epoch {0}: {1}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>i<span class="token punctuation">,</span> total_loss<span class="token operator">/</span>n_samples<span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># close the writer when you're done using it</span>
    writer<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span> 

    <span class="token comment" spellcheck="true"># Step 9: output the values of w and b</span>
    w_value<span class="token punctuation">,</span> b_value <span class="token operator">=</span> sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span>w<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span> 

<span class="token comment" spellcheck="true"># plot the results</span>
X<span class="token punctuation">,</span> Y <span class="token operator">=</span> data<span class="token punctuation">.</span>T<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>T<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> <span class="token string">'bo'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Real data'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> X <span class="token operator">*</span> w_value <span class="token operator">+</span> b_value<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Predicted data'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="data:image/png;base64,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TzvtNO/WrZuXlJSUb3v++efdzDw/Pz+mbOVzf/nll37yySf7sGHDYra3bdvWr7rqqirnilf3NWvWuJn5448/XmM9G4voz/WePXv8+utv9e7dh3q3bhd59+5D/bLLrnHAgb7ewN9jNU+IiERZtGgl4fCIuPvC4ZEsXLgyK49dxt0ZOnQonTp14phjjuHSSy+lbdu2LFy4kKOOOqq83PLly9m9ezeXX34527dvL3+YGf379+fFF18sL3vooYeW//uLL75g+/bt9O/fH3enuLi4TvXbsmULf//73xk7dixt27Yt3z506FBOPPHEKuWjz71r1y527tzJ2WefnfB5o1//5ZdfsmPHDo477jg6dOhQ57pnu7179zJgwBjmzBnAxo3L2bRpARs3LucvfzklaedQ84SISIS7U1rahqDZIB6jtDS3XmnfVB475ihmPPjgg/Ts2ZPdu3fzhz/8gVdeeaXKqIl//etfuDvnnHNO3GO0b9++/PnOnTuZOnUq//mf/8knn3wSU2737t11ql9ZX4IePXpU2derVy/eeOONmG3PPPMM06dP58033+SLL74o3x4KJXbPu3//fu68807mzp3Lpk2byrLX9ap7tpsz57FI09fIqK2G+78l7RwKGkREIsyMnJy9BJnceD/cTk7O3nr9qKfy2JWdccYZ5aMnRo8ezVlnncUVV1zB+vXryc3NBSAcDmNmPP7443Tp0qXKMVq2rPh5uPTSS1m9ejU//elPOfXUU2nbti3hcJgRI0YQDocbXN/qvPrqq4wePZrBgwfz0EMPceSRR5KTk8Mf/vAHCgsLEzrGhAkTmDdvHpMmTeLrX/867du3x8y47LLLUlr3THjllTcJhx9O6TkUNIiIRBk1aiBz5iytdLcWCIWWcNFFZ2XlsasTCoW46667OOecc3jggQf46U9/CgQdBd2dTp06MWTIkGpfv2vXLlasWMG0adO45ZZbyre/99579arPV77yFSDIdFS2fv36mOdPPfUUrVu3ZunSpTFBzO9///sqr60u2Jo/fz5jx47lnnvuKd/2xRdfsGvXrnrVP5t9+WVrqs9kJYf6NIiIRJk+/SZ6976PUGgxQVYAwAmFFtO790zuuOPHWXnsmnzjG9/gzDPPZNasWRw4cACAESNG0K5dO+68806+/PLLKq/Ztm0bAC1atACoclc+c+bMemVFunbtymmn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" alt=""></p>
<p>100次迭代之后，平均方差还是挺大的，拟合的不够好，所以考虑二次函数 Y = wXX + uX + b。</p>
<p>所以修改第3步和第4步。</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Step 3: create weight and bias, initialized to 0</span>
w <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'weights_1'</span><span class="token punctuation">)</span>
u <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"weights_2"</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'bias'</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># Step 4: build model to predict Y</span>
Y_predicted <span class="token operator">=</span> X <span class="token operator">*</span> X <span class="token operator">*</span> w <span class="token operator">+</span> X <span class="token operator">*</span> u <span class="token operator">+</span> b
</code></pre>
<p><img src="1.png" alt=""></p>
<blockquote>
<blockquote>
<p>二次函数的拟合需要改动多处代码。lecture 中并没有提出来，首先问题是 GradientDescentOptimizer 在此处并没有用，我试了一下，觉得 AdamOptimizer 是效果比较好的，当 learning_rate 是 0.001 时，最后的平均损失是 706.673181781，当 learning_rate 是 0.001 时，最后的平均损失是 596.339147409，深度学习真的和炼丹一样。</p>
</blockquote>
</blockquote>
<p>plt.scatter 也有个魔性的问题，好不容易解决了。这里附上完整代码</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=utf-8</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
<span class="token keyword">import</span> xlrd

DATA_FILE <span class="token operator">=</span> <span class="token string">'data/fire_theft.xls'</span>

<span class="token comment" spellcheck="true"># Step 1: read in data from the .xls file</span>
<span class="token comment" spellcheck="true"># book = xlrd.open_workbook(DATA_FILE, encoding_override="utf-8")</span>
<span class="token comment" spellcheck="true"># sheet = book.sheet_by_index(0)</span>
<span class="token comment" spellcheck="true"># data = np.asarray([sheet.row_values(i) for i in range(1, sheet.nrows)])</span>
<span class="token comment" spellcheck="true"># n_samples = sheet.nrows - 1</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd  <span class="token comment" spellcheck="true"># 使用pandas更简便</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>DATA_FILE<span class="token punctuation">)</span>
data <span class="token operator">=</span> df<span class="token punctuation">.</span>values
n_samples <span class="token operator">=</span> len<span class="token punctuation">(</span>df<span class="token punctuation">.</span>index<span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># Step 2: create placeholders for input X (number of fire) and label Y (number of theft)</span>
X <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'X'</span><span class="token punctuation">)</span>
Y <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'Y'</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># Step 3: create weight and bias, initialized to 0</span>
w <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'weights_1'</span><span class="token punctuation">)</span>
u <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"weights_2"</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'bias'</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># Step 4: build model to predict Y</span>
Y_predicted <span class="token operator">=</span> X <span class="token operator">*</span> X <span class="token operator">*</span> w <span class="token operator">+</span> X <span class="token operator">*</span> u <span class="token operator">+</span> b

<span class="token comment" spellcheck="true"># Step 5: use the square error as the loss function</span>
loss <span class="token operator">=</span> tf<span class="token punctuation">.</span>square<span class="token punctuation">(</span>Y <span class="token operator">-</span> Y_predicted<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'loss'</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># Step 6: using gradient descent with learning rate of 0.01 to minimize loss</span>
optimizer <span class="token operator">=</span> tf<span class="token punctuation">.</span>train<span class="token punctuation">.</span>AdamOptimizer<span class="token punctuation">(</span>learning_rate<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">.</span>minimize<span class="token punctuation">(</span>loss<span class="token punctuation">)</span>

<span class="token keyword">with</span> tf<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> sess<span class="token punctuation">:</span>
    <span class="token comment" spellcheck="true"># Step 7: initialize the necessary variables, in this case, w and b</span>
    sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>global_variables_initializer<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># writer = tf.summary.FileWriter('./my_graph/03/linear_reg', sess.graph)</span>

    <span class="token comment" spellcheck="true"># Step 8: train the model</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># train the model 100 times</span>
        total_loss <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> data<span class="token punctuation">:</span>
            <span class="token comment" spellcheck="true"># Session runs train_op and fetch values of loss</span>
            _<span class="token punctuation">,</span> l <span class="token operator">=</span> sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span>optimizer<span class="token punctuation">,</span> loss<span class="token punctuation">]</span><span class="token punctuation">,</span> feed_dict<span class="token operator">=</span><span class="token punctuation">{</span>X<span class="token punctuation">:</span> x<span class="token punctuation">,</span> Y<span class="token punctuation">:</span>y<span class="token punctuation">}</span><span class="token punctuation">)</span>
            total_loss <span class="token operator">+=</span> l

        <span class="token keyword">print</span> <span class="token string">'Epoch {0}: {1}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>i<span class="token punctuation">,</span> total_loss<span class="token operator">/</span>n_samples<span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># close the writer when you're done using it</span>
    <span class="token comment" spellcheck="true"># writer.close()</span>

    <span class="token comment" spellcheck="true"># Step 9: output the values of w and b</span>
    w_value<span class="token punctuation">,</span> u_value<span class="token punctuation">,</span> b_value <span class="token operator">=</span> sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span>w<span class="token punctuation">,</span> u<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># plot the results</span>
X<span class="token punctuation">,</span> Y <span class="token operator">=</span> data<span class="token punctuation">.</span>T<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>T<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> <span class="token string">'bo'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Real data'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">,</span> X <span class="token operator">*</span> X <span class="token operator">*</span> w_value <span class="token operator">+</span> X <span class="token operator">*</span> u_value <span class="token operator">+</span> b_value<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">'Predicted data'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<h6 id="u5206_u6790_u4EE3_u7801"><a href="#u5206_u6790_u4EE3_u7801" class="headerlink" title="分析代码"></a>分析代码</h6><p>通过上面的程序会发现，在创建完优化器后，用 ‘sess.run(optimizer, feed_dict={X: x, Y: y})’ 来运行程序。实际上 TensorFlow 将所有操作作为图的一部分来运算，同时 feed_dict 作为输入的数据，而 loss 是根据 w 和 b 计算得到的，其实 TensorFlow 会根据 loss 来自动求梯度。</p>
<h5 id="u4F18_u5316_u5668_28Optimizers_29"><a href="#u4F18_u5316_u5668_28Optimizers_29" class="headerlink" title="优化器(Optimizers)"></a>优化器(Optimizers)</h5><p>GradientDescentOptimizer 表示更新规则是按照梯度下降的。TensorFlow 可以自动求导，更新权重和偏差来计算损失值。</p>
<p>优化器默认是训练所有目标函数的可训练变量，当然可以通过设置修改变量为不可训练型。比如以下的例子：</p>
<pre class=" language-python"><code class="language-python">global_step <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>tf<span class="token punctuation">.</span>int32<span class="token punctuation">)</span>
learning_rate <span class="token operator">=</span> <span class="token number">0.01</span> <span class="token operator">*</span> <span class="token number">0.99</span> <span class="token operator">**</span> tf<span class="token punctuation">.</span>cast<span class="token punctuation">(</span>global_step<span class="token punctuation">,</span> tf<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
increment_step <span class="token operator">=</span> global_step<span class="token punctuation">.</span>assign_add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
optimizer <span class="token operator">=</span> tf<span class="token punctuation">.</span>GradientDescentOptimizer<span class="token punctuation">(</span>learning_rate<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># learning rate can be a tensor</span>
</code></pre>
<p>tf.Variable 类的完整定义如下：</p>
<pre class=" language-python"><code class="language-python">tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span>initial_value<span class="token operator">=</span>None<span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> collections<span class="token operator">=</span>None<span class="token punctuation">,</span> 
            validate_shape<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> caching_device<span class="token operator">=</span>None<span class="token punctuation">,</span> name<span class="token operator">=</span>None<span class="token punctuation">,</span>
            variable_def<span class="token operator">=</span>None<span class="token punctuation">,</span> dtype<span class="token operator">=</span>None<span class="token punctuation">,</span> expected_shape<span class="token operator">=</span>None<span class="token punctuation">,</span> 
            import_scope<span class="token operator">=</span>None<span class="token punctuation">)</span>
</code></pre>
<h6 id="Optimizer_u5217_u8868"><a href="#Optimizer_u5217_u8868" class="headerlink" title="Optimizer列表"></a>Optimizer列表</h6><p>目前常见的有:</p>
<pre><code>tf.train.GradientDescentOptimizer 
tf.train.AdadeltaOptimizer 
tf.train.AdagradOptimizer 
tf.train.AdagradDAOptimizer 
tf.train.MomentumOptimizer 
tf.train.AdamOptimizer 
tf.train.FtrlOptimizer 
tf.train.ProximalGradientDescentOptimizer 
tf.train.ProximalAdagradOptimizer 
tf.train.RMSPropOptimizer
</code></pre><p>这上面的一些可以参考CS231n中的内容。</p>
<h3 id="TensorFlow__u903B_u8F91_u56DE_u5F52"><a href="#TensorFlow__u903B_u8F91_u56DE_u5F52" class="headerlink" title="TensorFlow 逻辑回归"></a>TensorFlow 逻辑回归</h3><p>逻辑回归也是很重要的，这里使用逻辑回归来对 MNIST 分类。</p>
<p>MNIST 是著名的手写数字数据集。其中每个图片是 28 x 28 像素，被平滑成大小为784的1维张量，每个图片都有一个标签。</p>
<p>使用 TF Learn 可以简洁的读取数据集，同时使用 One-hot 编码。 One-hot 编码 是只有一位是1其他都为0的数组。</p>
<p>以下的完整代码我并没有测试 括弧哭</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>examples<span class="token punctuation">.</span>tutorials<span class="token punctuation">.</span>mnist <span class="token keyword">import</span> input_data

MNIST <span class="token operator">=</span> input_data<span class="token punctuation">.</span>read_data_sets<span class="token punctuation">(</span><span class="token string">"/data/mnist"</span><span class="token punctuation">,</span> one_hot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre>
<p>此时 MNIST 是一个对象，存放 55000 个训练数据和 10000 个测试数据，以及 5000 个验证集。</p>
<p>因为数据很大，所以为了加速训练，可以使用批量逻辑回归。首先修改 X_placeholder 和 Y_placeholder 的维度来适应 batch_size。</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> time
<span class="token keyword">import</span> numpy  <span class="token keyword">as</span>  np
<span class="token keyword">import</span> tensorflow  <span class="token keyword">as</span>  tf
<span class="token keyword">from</span>  tensorflow<span class="token punctuation">.</span>examples<span class="token punctuation">.</span>tutorials<span class="token punctuation">.</span>mnist <span class="token keyword">import</span> input_data

<span class="token comment" spellcheck="true"># Step 1: Read in data</span>
<span class="token comment" spellcheck="true"># using TF Learn's built in function to load MNIST data to the folder data/mnist</span>
MNIST <span class="token operator">=</span> input_data<span class="token punctuation">.</span>read_data_sets<span class="token punctuation">(</span><span class="token string">"/data/mnist"</span><span class="token punctuation">,</span> one_hot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># Step 2: Define parameters for the model</span>
learning_rate <span class="token operator">=</span> <span class="token number">0.01</span>
batch_size <span class="token operator">=</span> <span class="token number">128</span>
n_epochs <span class="token operator">=</span> <span class="token number">25</span>

<span class="token comment" spellcheck="true"># Step 3: create placeholders for features and labels</span>
<span class="token comment" spellcheck="true"># each image in the MNIST data is of shape 28*28 = 784</span>
<span class="token comment" spellcheck="true"># therefore, each image is represented with a 1x784 tensor</span>
<span class="token comment" spellcheck="true"># there are 10 classes for each image, corresponding to digits 0 - 9. # each label is one hot vector.</span>
X <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> <span class="token punctuation">[</span>batch_size<span class="token punctuation">,</span> <span class="token number">784</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
Y <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> <span class="token punctuation">[</span>batch_size<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># Step 4: create weights and bias</span>
<span class="token comment" spellcheck="true"># w is initialized to random variables with mean of 0, stddev of 0.01</span>
<span class="token comment" spellcheck="true"># b is initialized to 0</span>
<span class="token comment" spellcheck="true"># shape of w depends on the dimension of X and Y so that Y = tf.matmul(X, w)</span>
<span class="token comment" spellcheck="true"># shape of b depends on Y</span>
w <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>random_normal<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">784</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stddev<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"weights"</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"bias"</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># Step 5: predict Y from X and w, b</span>
<span class="token comment" spellcheck="true"># the model that returns probability distribution of possible label of the image # through the softmax layer</span>
<span class="token comment" spellcheck="true"># a batch_size x 10 tensor that represents the possibility of the digits</span>
logits <span class="token operator">=</span> tf<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>X<span class="token punctuation">,</span> w<span class="token punctuation">)</span> <span class="token operator">+</span> b

<span class="token comment" spellcheck="true"># Step 6: define loss function</span>
<span class="token comment" spellcheck="true"># use softmax cross entropy with logits as the loss function</span>
<span class="token comment" spellcheck="true"># compute mean cross entropy, softmax is applied internally</span>
entropy <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>softmax_cross_entropy_with_logits<span class="token punctuation">(</span>logits<span class="token punctuation">,</span> Y<span class="token punctuation">)</span>
loss <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_mean<span class="token punctuation">(</span>entropy<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># computes the mean over examples in the batch</span>

<span class="token comment" spellcheck="true"># Step 7: define training op</span>
<span class="token comment" spellcheck="true"># using gradient descent with learning rate of 0.01 to minimize cost </span>
optimizer <span class="token operator">=</span> tf<span class="token punctuation">.</span>train<span class="token punctuation">.</span>GradientDescentOptimizer<span class="token punctuation">(</span>learning_rate<span class="token operator">=</span>learning_rate<span class="token punctuation">)</span><span class="token punctuation">.</span>minimize<span class="token punctuation">(</span>loss<span class="token punctuation">)</span>
init <span class="token operator">=</span> tf<span class="token punctuation">.</span>global_variables_initializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">with</span>  tf<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> sess<span class="token punctuation">:</span>
    sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>init<span class="token punctuation">)</span>
    n_batches <span class="token operator">=</span> int<span class="token punctuation">(</span>MNIST<span class="token punctuation">.</span>train<span class="token punctuation">.</span>num_examples <span class="token operator">/</span> batch_size<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>n_epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># train the model n_epochs times</span>
        <span class="token keyword">for</span> _ <span class="token keyword">in</span> range<span class="token punctuation">(</span>n_batches<span class="token punctuation">)</span><span class="token punctuation">:</span>
            X_batch<span class="token punctuation">,</span> Y_batch <span class="token operator">=</span> MNIST<span class="token punctuation">.</span>train<span class="token punctuation">.</span>next_batch<span class="token punctuation">(</span>batch_size<span class="token punctuation">)</span>
        sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span>optimizer<span class="token punctuation">,</span> loss<span class="token punctuation">]</span><span class="token punctuation">,</span> feed_dict<span class="token operator">=</span><span class="token punctuation">{</span>X<span class="token punctuation">:</span> X_batch<span class="token punctuation">,</span> Y<span class="token punctuation">:</span> Y_batch<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># average loss should be around 0.35 after 25 epochs</span>

<span class="token comment" spellcheck="true"># test the model</span>
n_batches <span class="token operator">=</span> int<span class="token punctuation">(</span>MNIST<span class="token punctuation">.</span>test<span class="token punctuation">.</span>num_examples <span class="token operator">/</span> batch_size<span class="token punctuation">)</span>
total_correct_preds <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>n_batches<span class="token punctuation">)</span><span class="token punctuation">:</span>
    X_batch<span class="token punctuation">,</span> Y_batch <span class="token operator">=</span> MNIST<span class="token punctuation">.</span>test<span class="token punctuation">.</span>next_batch<span class="token punctuation">(</span>batch_size<span class="token punctuation">)</span>
    _<span class="token punctuation">,</span> loss_batch<span class="token punctuation">,</span> logits_batch <span class="token operator">=</span> sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span>optimizer<span class="token punctuation">,</span> loss<span class="token punctuation">,</span> logits<span class="token punctuation">]</span><span class="token punctuation">,</span> feed_dict<span class="token operator">=</span><span class="token punctuation">{</span>X<span class="token punctuation">:</span> X_batch<span class="token punctuation">,</span> Y<span class="token punctuation">:</span> Y_batch<span class="token punctuation">}</span><span class="token punctuation">)</span>
    preds <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>softmax<span class="token punctuation">(</span>logits_batch<span class="token punctuation">)</span>
    correct_preds <span class="token operator">=</span> tf<span class="token punctuation">.</span>equal<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>preds<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tf<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>Y_batch<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    accuracy <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>cast<span class="token punctuation">(</span>correct_preds<span class="token punctuation">,</span> tf<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># similar to numpy.count_nonzero(boolarray) :(</span>
    total_correct_preds <span class="token operator">+=</span> sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>accuracy<span class="token punctuation">)</span>
    <span class="token keyword">print</span>   <span class="token string">"Accuracy {0}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>total_correct_preds <span class="token operator">/</span> MNIST<span class="token punctuation">.</span>test<span class="token punctuation">.</span>num_examples<span class="token punctuation">)</span>
</code></pre>
<h5 id="u603B_u7ED3"><a href="#u603B_u7ED3" class="headerlink" title="总结"></a>总结</h5><p>lecture 3 学习了线性回归和逻辑回归，官方笔记里有一些坑，或多或少填完了这个坑，争取在考研的过程中能把这门可和cs229过一遍。</p>

    

    
</div>


                

                <!-- Post Comments -->
                
                    


    <!-- 使用 DISQUS -->
    <div id="disqus-comment">
        <div id="disqus_thread"></div>
<script>
    queue.offer(function() {
            var disqus_config = function () {
                this.page.url = 'http://xinqiu.me/2017/03/06/cs20si-3/index.html';  // Replace PAGE_URL with your page's canonical URL variable
                this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
            };

            (function() { // DON'T EDIT BELOW THIS LINE
                var d = document;
                var s = d.createElement('script');
                s.src = '//xinqiu.disqus.com/embed.js';
                s.setAttribute('data-timestamp', + new Date());
                (d.head || d.body).appendChild(s);
            })();
        });
</script>

    </div>
    <style>
        #disqus-comment{
            background-color: #eee;
            padding: 2pc;
        }
    </style>



                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/05/09/a-byte-of-go/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Newer
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/02/10/CS231n-1/" id="post_nav-older" class="next-content">
            Older
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/snow_square.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="Xin Qiu's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        xinqiu.94@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/" target="_self">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                Home
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    Archives
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2017/05/">May 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">March 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/02/">February 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/01/">January 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/12/">December 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/10/">October 2016<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/08/">August 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/07/">July 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/06/">June 2016<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/05/">May 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/04/">April 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/03/">March 2016<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/02/">February 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/01/">January 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/12/">December 2015<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/11/">November 2015<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/10/">October 2015<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/09/">September 2015<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/08/">August 2015<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/07/">July 2015<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/06/">June 2015<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/05/">May 2015<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/03/">March 2015<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/02/">February 2015<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/01/">January 2015<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2014/12/">December 2014<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    

    <!-- Pages  -->
    
        <li>
            <a href="/about" title="About">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                About
            </a>
        </li>
        
    
        <li>
            <a href="/projects" title="Projects">
                
                    <i class="material-icons sidebar-material-icons">build</i>
                
                Projects
            </a>
        </li>
        
    
        <li>
            <a href="/reading-list" title="Reading">
                
                    <i class="material-icons sidebar-material-icons">book</i>
                
                Reading
            </a>
        </li>
        
    
        <li>
            <a href="/timeline" title="Timeline">
                
                    <i class="material-icons sidebar-material-icons">timeline</i>
                
                Timeline
            </a>
        </li>
        
    
        <li>
            <a href="/tags" title="Tags">
                
                    <i class="material-icons sidebar-material-icons">bookmark border</i>
                
                Tags
            </a>
        </li>
        
            <li class="divider"></li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                Number of articles
                <span class="sidebar-badge">45</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/xinqiu" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.png);">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;
            <script type="text/javascript">
                var fd = new Date();
                document.write(fd.getFullYear());
            </script>
            &nbsp;一人Code
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import File -->
<script src="/js/lazyload.min.js"></script>
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>





    <!-- Leancloud -->
    <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
    <script>
        AV.initialize('wNFmCWTd6GAdUBwK4C35gD2G-gzGzoHsz', 'fkjBgbCuEaEEKpksFNIkGYsk');
    </script>
    <script>
    function showTime(Counter) {
        var query = new AV.Query(Counter);
        $('.leancloud-views_num').each(function() {
            var url = $(this).attr('id').trim();
            query.equalTo('url', url);
            query.find({
                success: function(results) {
                    if (results.length === 0) {
                        var content = '0 ' + $(document.getElementById(url)).text();
                        $(document.getElementById(url)).text(content);
                        return;
                    }
                    for (var i = 0; i < results.length; i++) {
                        var object = results[i];
                        var content = object.get('time') + ' ' + $(document.getElementById(url)).text();
                        $(document.getElementById(url)).text(content);
                    }
                },
                error: function(object, error) {
                    console.log('Error: ' + error.code + ' ' + error.message);
                }
            });
        });
    }

    function addCount(Counter) {
      var Counter = AV.Object.extend('Counter');
      url = $('.leancloud-views_num').attr('id').trim();
      title = $('.leancloud-views_num').attr('data-flag-title').trim();
      var query = new AV.Query(Counter);
      query.equalTo('url', url);
      query.find({
          success: function(results) {
            if (results.length > 0) {
                var counter = results[0];
                counter.fetchWhenSave(true);
                counter.increment('time');
                counter.save(null, {
                    success: function(counter) {
                        var content =  counter.get('time') + ' ' + $(document.getElementById(url)).text();
                        $(document.getElementById(url)).text(content);
                    },
                    error: function(counter, error) {
                        console.log('Failed to save Visitor num, with error message: ' + error.message);
                    }
                });
            } else {
              var newcounter = new Counter();
              newcounter.set('title', title);
              newcounter.set('url', url);
              newcounter.set('time', 1);
              newcounter.save(null, {
                  success: function(newcounter) {
                      console.log('newcounter.get(\'time\')='+newcounter.get('time'));
                      var content = newcounter.get('time') + ' ' + $(document.getElementById(url)).text();
                      $(document.getElementById(url)).text(content);
                  },
                  error: function(newcounter, error) {
                      console.log('Failed to create');
                  }
              });
            }
        },
        error: function(error) {
            console.log('Error:' + error.code + ' ' + error.message);
        }
      });
    }
    $(function() {
        var Counter = AV.Object.extend('Counter');
        if ($('.leancloud-views_num').length === 1) {
            addCount(Counter);
        } else if ($('.post-title-link').length > 1) {
            showTime(Counter);
        }
    });
</script>








    <!-- 使用 DISQUS js 代码 -->
    <script id="dsq-count-scr" src="//xinqiu.disqus.com/count.js" async></script>



<!-- Swiftye -->


<!-- Local Search-->

    <script>
    var searchFunc = function(path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: 'xml',
            success: function( xmlResponse ) {
                // get the contents from search data
                var datas = $( 'entry', xmlResponse ).map(function() {
                    return {
                        title: $( 'title', this ).text(),
                        content: $('content',this).text(),
                        url: $( 'url' , this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function() {
                    var str='<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = '';
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function(data) {
                        var isMatch = true;
                        var content_index = [];
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g,'').toLowerCase();
                        var data_url = data.url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if(data_title !== '' && data_content !== '') {
                            keywords.forEach(function(keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if( index_title < 0 && index_content < 0 ) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += '<li><a href="'+ data_url +'" class="search-result-title" target="_blank">'+ data_title;
                            var content = data.content.trim().replace(/<[^>]+>/g, '');
                            if (first_occur >= 0) {
                                // cut out characters
                                var start = first_occur - 6;
                                var end = first_occur + 6;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 10;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function(keyword) {
                                    var regS = new RegExp(keyword, 'gi');
                                    match_content = match_content.replace(regS, '<em class="search-keyword">'+keyword+'</em>');
                                })
                                str += '<p class="search-result">' + match_content + '...</p>' +'</a>';
                            }
                        }
                    });
                    $resultContent.innerHTML = str;
                });
            }
        });
    }
</script>


    <script>
        var inputArea = document.querySelector('#search');
        var getSearchFile = function() {
            var path = 'search.xml';
            searchFunc(path, 'search', 'local-search-result');
        }

        if(inputArea) {
            inputArea.onfocus = function() {
                getSearchFile();
            }
        }
    </script>


<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->


                </main>
            </div>
        </body>
    
</html>
